document.addEventListener("DOMContentLoaded",()=>{const s=document.getElementById("update-form"),c=document.getElementById("close-dialog"),t=document.getElementById("dialog2"),i=document.getElementById("delete-this-item");if(!s||!c||!t){console.error("One or more elements are missing");return}c.addEventListener("click",()=>t.close()),t.addEventListener("click",o=>{o.target===o.currentTarget&&t.close()}),i?.addEventListener("click",async o=>{const r=new FormData(s).get("id");o.preventDefault();try{const n=await(await fetch(`/api/${r}.json`,{method:"DELETE",headers:{"Content-Type":"application/json"}})).json();if(console.log(n),n.success)t.close(),location.reload();else throw new Error(n.message);console.log("deleted")}catch(a){console.error(a)}}),s.addEventListener("submit",async o=>{o.preventDefault();try{const e=new FormData(s),r={id:e.get("id"),partnumber:e.get("partnumber"),description:e.get("description"),qty:e.get("qty"),url:e.get("url"),safeqty:e.get("safeqty"),types:e.get("types")},n=await(await fetch(`/api/${r.id}.json`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).json();if(n.success)t.close(),location.reload();else throw new Error(n.message)}catch(e){e instanceof Error?alert(e.message):console.error("An unknown error occurred:",e)}})});
